# Description
This folder contains supporting scripts for getting malware type and family labels. The following will provide details of each script and guide on how to run them.

# get_VTreport.py

## Details
This script uses virustotal report api to get virustotal report, based on the input list of hashes and save the reports as json files in folder, "json_reports". 
A logfile will be created to log the status of each call of virustotal report api. 
Configuration is to be done in the script (placed in __main__) before running. 

### Configuration options
- START_HASH	: Start index of hash list to analyse
- END_HASH		: End index of hash list to analyse
- hash_file		: Path to text file, containing the list of hashes to be sent to virustotal
- apikey		: Apikey to be used for virustotal api function; an unique apikey is given for each virustotal account

### How-to-run 
		
`$ python get_VTreport.py`
> Only run after configuration is done! 

# getmaltyp.py

## Details
This script gets the returned results from 1 specified anti-virus scanner (Malwarebytes/Microsoft) in virustotal reports and saves the results as a text file. 
The script looks out for 4 conditions before getting the results. A log file will be created to log all samples that do not meet any of the 4 conditions. 
Configuration is to be done in the script (placed at the top) before running. 

### Conditions
1) if the virustotal report has any results of the analysed hash
2) if the malicious score (positives/total number of anti-virus scanners) >= THRESHOLD_SCORE (user can set this score at the top of the script)
3) if the specified anti-virus scanner is in the list of anti-virus scanners in the report
4) if the specified anti-virus scanner detect the hash sample as malicious     

### Configuration Options
- THRESHOLD_SCORE	: Threshold to set in determining if a sample hash can be classified as malicious; current threshold set = 10  		

## How-to-run

### Get Malwarebytes(0) results

`$ python getmaltyp.py <dir containing json reports to get results from> 0`

### Get Microsoft(1) results

`$ python getmaltyp.py <dir containing json reports to get results from> 1`

# getmaltyp_5.py

## Details
This script works like `getmaltyp.py` but allows user to get results from >1 anti-virus scanners. The results will be saved in a csv file. Configuration is to be done in the script (placed in __main__) before running. 

### Configuration options
- json_reports_dir	: Directory containing json reports to get results from
- csvfile		    : Name of csv file to save

## How-to-run 
		
`$ python getmaltyp_5.py`
> Only run after configuration is done! 

# getstats.py

## Details
This script processes the malware type/family labels text files and gets sample size of each malware type/family label before saving the data into a text file. This script also processes malware type results, obtained from virustotal reports, and save the results into a text file. Currently, the script only processes results from Malwarebytes and Microsoft.

## How-to-run 

### Process Malwarebytes results
`$ python getstats.py <file containing malware type labels> malwarebytes` 

### Process Microsoft results
`$ python getstats.py <file containing malware type labels> microsoft`

### Process Malware family results
`$ python getstats.py <file containing malware family labels>`

# add_maltyp.py

## Details
This script adds malware types to malware dataset csv file as "maltype" column and removes any samples without malware types before saving the new dataset as csv file. 
Configuration is to be done in the script (placed in __main__) before running.

### Configuration options
- maltypfile		    : Text file that contains the malware type labels to be added 
- maldataset		    : Csv file of malware dataset to add malware type labels
- maltyp_list(optional) : List of malware types to be added; this option allows user to select a number of malware types to be added 
- csvfilename		    : Csv filename of the new dataset; after adding malware type labels 

## How-to-run

` $ python add_maltyp.py`
> Only run after configuration is done!

# add_malfam.py

## Details
This script adds malware families to malware dataset csv file as "malfamily" column and removes any samples without malware families before saving the new dataset as csv file. 
Configuration is to be done in the script (placed in __main__) before running.

### Configuration options
- malfamfile		: Text file that contains the malware family labels to be added 
- maldataset		: Csv file of malware dataset to add malware type labels
- target_fam(optional)  : List of malware families to be added; this option allows user to select a number of malware families to be added
- csvfilename		: Csv filename of the new dataset; after adding malware family labels 

## How-to-run

` $ python add_malfam.py`
> Only run after configuration is done!